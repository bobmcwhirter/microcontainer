<project name="build-jboss-head" default="publish">
    <property name="log.dir" value="${basedir}/logbuild/jboss-head-repository"/>
    <property name="cvs.repository" value=":pserver:anonymous@anoncvs.forge.jboss.com:/cvsroot/jboss"/>

    <target name="clean-logs" depends="" description="Cleans checkout directory">
        <delete includeemptydirs="true">
          <fileset dir="../checkout/jboss-head-repository" includes="**/*"/>
        </delete>
        <delete dir="${log.dir}"/>
        <mkdir dir="${log.dir}"/>
    </target>

    <target name="checkout" depends="clean-logs" description="Update packages from CVS">
        <sequential>
        <cvs command="co "
             cvsroot="${cvs.repository}"
             compressionlevel="3"
             dest="../checkout/jboss-head-repository"
             package="jbossas"
             output="${log.dir}/cvsco.log"/>
        <cvs command="co "
             cvsroot="${cvs.repository}"
             compressionlevel="3"
             dest="../checkout/jboss-head-repository"
             package="tools"
             output="${log.dir}/cvsco.log"
             append="true"/>
        </sequential>
    </target>

    <target name="synchronize" depends="checkout">
      <ant antfile="build.xml"
           dir="../checkout/jboss-head-repository/jbossas"
           output="${log.dir}/synchronize.log"
           target="synchronize"/>
    </target>

    <target name="clean" depends="synchronize">
      <ant antfile="build.xml"
           dir="../checkout/jboss-head-repository/jbossas"
           output="${log.dir}/clean.log"
           target="clean"/>
    </target>

    <target name="build" depends="clean">
      <ant antfile="build.xml"
           dir="../checkout/jboss-head-repository/jbossas"
           output="${log.dir}/compile.log"
           target="build"/>
    </target>

    <target name="publish" depends="build">
      <ant antfile="build.xml"
           dir="../checkout/jboss-head-repository/jbossas"
           output="${log.dir}/publish.log"
           target="publish">
        <property name="repository.root" value="/home/cruisecontrol/tomcat/webapps/repository"/>
      </ant>
    </target>
</project>

