<project name="build-cruisecontrol" default="build">

    <property name="cvs.repository" value=":pserver:anonymous@anoncvs.forge.jboss.com:/cvsroot/jboss"/>
    <property name="log.dir" value="${basedir}/logbuild/cruisecontrol"/>
    <import file="build-common.xml"/>

    <target name="clean" depends="" description="Cleans checkout directory">
        <antcall target="clean.checkout">
           <param name="checkout.dir" value="../checkout/cruisecontrol"/>
           <param name="artifacts.dir" value="${log.dir}"/>
        </antcall>
    </target>

    <target name="getcode" depends="clean" description="Update packages from CVS">
        <svn>
            <checkout url="${svn.url}" destPath="../checkout/${jboss.dir}"/>
        </svn> 
    </target>

    <target name="build" depends="getcode" description="Build the cruisecontrol project">
        <sequential>
        <copy todir=".">
           <fileset dir="../checkout/cruisecontrol/scripts" excludes="*.properties"/>
        </copy>
        <copy todir="../templates">
           <fileset dir="../checkout/cruisecontrol/templates"/>
        </copy>
        <exec dir="../templates" executable="bash">
            <arg value="-c"/>
            <arg value="sh create-cc-config.sh"/>
        </exec>
        <copy file="../templates/cc-config.xml" todir="."/>
        <copy file="../templates/cc-db-config.xml" todir="."/>
        <copy file="../templates/cc-web-config.xml" todir="."/>
        <copy file="../templates/cc-matrix-config.xml" todir="."/>
  	<copy todir=".">
    	 <fileset dir="../checkout/cruisecontrol/scripts">
    	   <include name="*.properties"/>
    	   <exclude name="customize.properties"/>
    	   <exclude name="committer-list.properties"/>
    	   <exclude name="jdbc.properties"/>
   	 </fileset>
 	</copy>        
        </sequential>
    </target>
</project>

